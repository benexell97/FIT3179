{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "title": "COVID-19 Active Cases (10 Oct 2020)",
  "width": 800,
  "height": 600,
  "projection": {
    "type": "equirectangular"
  },
  "layer":[
    {
      "data": {
        "url": "https://raw.githubusercontent.com/benexell97/FIT3179/gh-pages/js/worldmap.topojson",
        "format": {
              "type": "topojson",
              "feature": "custom"
            }
      },
      "transform": [{
          "lookup": "properties.name",
          "from": {
            "data": {
              "url": "https://raw.githubusercontent.com/KaneSec/vega_lite/main/3_choropleth_map/data/covid_10_10_2020.csv"
            },
            "key": "Country",
            "fields": ["Active"]
          }
        },
        {"calculate": "datum.Active + 0.1", "as": "Active Cases"}
      ],
      "mark": {
        "type": "geoshape"
        },
      "encoding": {
        "color": {
          "field": "Active Cases",
          "type": "quantitative",
          "scale": {"type": "log"}
        },
        "tooltip": [
          {"field": "properties.name", "type": "nominal", "title": "Country"},
          {"field": "Active", "type": "quantitative"}
        ]
      },
    },
    {
      "data": [
        {
          "name": "world",
          "url": "data/ne_110m_graticules_30.json",
          "format": {
            "type": "topojson",
            "feature": "ne_110m_graticules_30"
          }
        },
        {
          "name": "graticule",
          "transform": [
            { "type": "graticule" }
          ]
        }
      ],

      "layer":[
        {
            "mark": [
                {
                  "type": "shape",
                  "from": {"data": "graticule"},
                  "encode": {
                    "update": {
                      "strokeWidth": {"value": 1},
                      "strokeDash": {"signal": "[+graticuleDash, +graticuleDash]"},
                      "stroke": {"signal": "invert ? '#444' : '#ddd'"},
                    }
                  },
                  "transform": [
                    { "type": "geoshape", "projection": "projection" }
                  ]
              }]
        }]
    }

  ]
}
